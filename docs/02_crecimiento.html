<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>2 Crecimiento</title>

<script src="site_libs/header-attrs-2.1/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Ecofisiología práctica</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="01_desarrollo.html">Desarrollo</a>
</li>
<li>
  <a href="02_crecimiento.html">Crecimiento</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://juanchiem.github.io/blog/">
    <span class="fa fa-github-square"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">2 Crecimiento</h1>

</div>


<ol style="list-style-type: decimal">
<li>Calcule el coeficiente de extinción lumínica (k) para los canopeos de los cultivos A y B en función de los datos proporcionados.</li>
</ol>
<table class=" lightable-paper lightable-hover" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
L
</th>
<th style="text-align:right;">
A
</th>
<th style="text-align:right;">
B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2000
</td>
<td style="text-align:right;">
2000
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1000
</td>
<td style="text-align:right;">
500
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
125
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
31
</td>
</tr>
</tbody>
</table>
<p>Donde:</p>
<p>L: índice de área foliar acumulado (<span class="math inline">\(m^{2} m^{-2}\)</span>). Es decir, en L=1 la radiación atravesó 1m² de hojas/m² de suelo, y así sucesivamente. L sería un “Delta AF”, o sea si usamos la planta entera L=4, 4 m² de AF fueron atravesados (3.</p>
<p>I: radiación (μmol <span class="math inline">\(m^{-2} seg^{-1}\)</span>) incidente sobre el tope de cada estrato foliar (L)</p>
<div class="infobox">
<p>La fracción de RFA inerceptada (<span class="math inline">\(fRFA\)</span>) y el índice de área foliar (<span class="math inline">\(IAF\)</span>) fueron relacionados según Monsi y Saeki <span class="citation">(<a href="#ref-monsi1953light" role="doc-biblioref">1953</a>)</span> en una función no lineal dada por:</p>
<p><span class="math inline">\(fRFA = e^{-k * l}\)</span></p>
<p>reemplazando:</p>
<p><span class="math inline">\(\frac{I}{I_0} = e^{-k * l}\)</span></p>
<p>linearizando por medio de aplicación de logaritmo natural (<code>log</code> en <code>R</code>) a ambos lados de la ecuación, obtenemos:</p>
<p><span class="math inline">\(ln\frac{I}{I_0} = ln(e^{-k * l})\)</span></p>
<p>y su equivalencia:</p>
<p><span class="math inline">\(ln\frac{I}{I_0} = -k * l\)</span></p>
<p>resolviendo finalmente:</p>
<p><span class="math inline">\(k = \frac{-ln(I/I_0)}{L-L_0}\)</span></p>
</div>
<p>Para el caso <span class="math inline">\(A\)</span> tomamos los valores de <span class="math inline">\(L=1, 2\)</span> y sus respectivos valores de <span class="math inline">\(I = 2000, 1000\)</span>.</p>
<p>(Obviamente se puede tomar cualquier valor de la tabla. Verificar que el resultado siempre es el mismo)</p>
<p><span class="math inline">\(ln\frac{1000}{2000} = -k * l\)</span></p>
<p>Ej de cálculo para A:</p>
<pre class="r"><code>k_A1 = -log(1000/2000)
k_A1</code></pre>
<pre><code>## [1] 0.6931472</code></pre>
<pre class="r"><code>k_A2 = -log(250/2000)/(4-1)
k_A2</code></pre>
<pre><code>## [1] 0.6931472</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Para el caso <span class="math inline">\(B\)</span> tomamos los valores de <span class="math inline">\(L=1,3\)</span> y sus respectivos valores de <span class="math inline">\(I=2000, 125\)</span></li>
</ol>
<p>Ej de cálculo para B:</p>
<pre class="r"><code>k_B1 = -log(125/2000)/(3-1)
k_B1</code></pre>
<pre><code>## [1] 1.386294</code></pre>
<p>Ahora que hemos estimado <code>k</code> podremos visualizar ambos canopeos por reemplazo de la ecuación</p>
<pre class="r"><code>fraccion_interceptada_A &lt;- function(x) exp(- k_A1*x)
fraccion_interceptada_B &lt;- function(x) exp(- k_B1*x)

ggplot(data.frame(x = c(0, 5)), aes(x)) + 
  stat_function(fun = fraccion_interceptada_A, aes(colour = paste0(&quot;k = &quot;, round(k_A1,1))))+ 
  stat_function(fun = fraccion_interceptada_B, aes(colour = paste0(&quot;k = &quot;, round(k_B1,1))))+ 
  labs(x=&quot;IAF&quot;, y = &quot;I/I0&quot;,
       title = &quot;Curva de fracción de RFA Int en el canopeo&quot;,  
       col = &quot;&quot;) </code></pre>
<p><img src="02_crecimiento_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Ejemplo de k bajos es el maíz (canopias erectófilas dejan pasar más luz. k= 0.3 aprox), mientras que canopias planófilas, como el girasol, presentan coeficientes más altos (ej. k= 1,5).</p>
<hr />
<ol start="5" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Disponemos de una ecuación matemática logística que describe la acumulación de materia seca de un cultivo en función de los días desde la emergencia ¿Cómo podríamos estimar la tasa de crecimiento para un día determinado, y la máxima tasa de crecimiento que alcanza el cultivo?</li>
</ol></li>
</ol>
<p>A continuación visualizaremos la curva de acumulación de materia seca de un cultivo: (nótese que esto deberia realizarse por medio de la evaluación empírica de muchos puntos en el tiempo de medición de MS, y luego la estimación de los parámetros. Para fines didácticos, presentamos una función ya con sus parámetros estimados)</p>
<p>f(x) = asintota / (1 + exp((punto_medio - x) * escala))</p>
<p><span class="math inline">\(asintota = 8000\)</span></p>
<p><span class="math inline">\(punto\_medio = 70\)</span></p>
<p><span class="math inline">\(escala = 0.1\)</span></p>
<pre class="r"><code># para visualizar las funciones en ggplot usaremos la siguiente funcion `function()`:

f1 &lt;- function(x) 8000 / (1 + exp((70 - x) * 0.1))

p1 &lt;- ggplot(data.frame(x = c(0, 120)), aes(x)) + 
  stat_function(fun = f1, col = &quot;red3&quot;)+ 
  labs(x=&quot;Dias desde emergencia&quot;, y = &quot;kg/ha&quot;,
       title = &quot;Curva de acumulación de MS&quot;,  
       subtitle = &quot;y=f(x)&quot;) +
  scale_x_continuous(
    name = &quot;Dias&quot;, 
    limits = c(0, 120), 
    breaks = scales::extended_breaks(Q = c(30, 10)))  

p1</code></pre>
<p><img src="02_crecimiento_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Para responder a la actividad propuesta, de obtener las tasas de crecimiento instantáneas, derivaremos <span class="math inline">\(f1\)</span>:</p>
<pre class="r"><code># para  hacer operaciones de cálculo en R usamos la función `expression`
f1_expre = expression(8000 / (1 + exp((70 - x) * 0.1)))
f1_expre</code></pre>
<pre><code>## expression(8000/(1 + exp((70 - x) * 0.1)))</code></pre>
<pre class="r"><code>f2_express &lt;- D(f1_expre, &quot;x&quot;) # derivada 1° de f1

# Para graficas pasamos de &quot;express&quot; a &quot;function&quot; 
f1_deriv &lt;- function(x) 8000 * (exp((70 - x) * 0.1) * 0.1)/(1 + exp((70 - x) * 0.1))^2
# optimize(f1_deriv, interval=c(30, 60), maximum=TRUE)

p2 &lt;- ggplot(data.frame(x = c(0, 120)), aes(x)) + 
  stat_function(fun = f1_deriv, col= &quot;steelblue&quot;) +
  labs(x=&quot;Dias desde emergencia&quot;, y = &quot;kg/ha/dia&quot;, 
       title= &quot;Tasa instantánea de crecimiento&quot;,  
       subtitle = &quot;y=f&#39;(x)&quot;) +
  scale_x_continuous(
    name = &quot;Dias&quot;, 
    limits = c(0, 120), 
    breaks = scales::extended_breaks(Q = c(30, 10)))#+
p2</code></pre>
<p><img src="02_crecimiento_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>f3_express &lt;- D(D(f1_expre,&#39;x&#39;),&#39;x&#39;)# derivada 2° de f1

f1_deriv2 &lt;- function(x) -(8000 * (exp((70 - x) * 0.1) * 0.1 * 0.1)/(1 + exp((70 - x) * 
    0.1))^2 - 8000 * (exp((70 - x) * 0.1) * 0.1) * (2 * (exp((70 - 
    x) * 0.1) * 0.1 * (1 + exp((70 - x) * 0.1))))/((1 + exp((70 - 
    x) * 0.1))^2)^2)

p3 &lt;- ggplot(data.frame(x = c(0, 120)), aes(x)) + 
  stat_function(fun = f1_deriv2, col= &quot;green3&quot;) +
  labs(x=&quot;Dias desde emergencia&quot;, y = &quot;&quot;, 
       title= &quot;Segunda derivada&quot;,  
       subtitle = &quot;y=f&#39;&#39;(x)&quot;) +
  scale_x_continuous(
    name = &quot;Dias&quot;, 
    limits = c(0, 120), 
    breaks = scales::extended_breaks(Q = c(30, 10))) 
p3</code></pre>
<p><img src="02_crecimiento_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Respondiendo al inciso b) Cómo podríamos determinar la biomasa que se acumuló entre dos momentos del ciclo usando la función de tasa de acumulación instantánea.</p>
<pre class="r"><code>df = data.frame(x = seq(1, 120, length.out = 120))
df$y = f1_deriv(df$x)

int_30_60 &lt;- integrate(f1_deriv,30,60)
int_60_90 &lt;- integrate(f1_deriv,60,90)
int_90_120 &lt;- integrate(f1_deriv,90,120)

ggplot(df, aes(x, y)) + 
  geom_line()+
  labs(x=&quot;Dias desde emergencia&quot;, y = &quot;kg/ha/dia&quot;,  
       title = &quot;Tasa instantanea de crecimiento&quot;, 
       subtitle = &quot;Integral de y=f&#39;(x) para intervalo t1:t2&quot;) +
  scale_x_continuous(
    limits = c(0, 120), 
    breaks = scales::extended_breaks(Q = c(30, 10)))+
  geom_area(data = df[df$x &gt;= 30 &amp; df$x &lt;= 60,], aes(x = x, y = y),
            fill = &quot;red&quot;, alpha = 0.5)+
  annotate(&quot;text&quot;, x = 45, y = -Inf, vjust = -2,
           label = round(int_30_60$value,0))+
  geom_area(data = df[df$x &gt;= 60 &amp; df$x &lt;= 90,], aes(x = x, y = y),
            fill = &quot;green3&quot;, alpha = 0.5)+
  annotate(&quot;text&quot;, x = 75, y = -Inf, vjust = -2,
           label = round(int_60_90$value,0))+
  geom_area(data = df[df$x &gt;= 90 &amp; df$x &lt;= 120,], aes(x = x, y = y),
            fill = &quot;steelblue&quot;, alpha = 0.5)+
  annotate(&quot;text&quot;, x = 105, y = -Inf, vjust = -2,
           label = round(int_90_120$value,0))</code></pre>
<p><img src="02_crecimiento_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code># ggsave(last_plot(), file = &quot;figs/integral.png&quot;, w =5, h = 4)</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>La producción de biomasa de soja es marcadamente inferior a la de maíz. De acuerdo a Andrade y col <span class="citation">(<a href="#ref-andrade1995analysis" role="doc-biblioref">1995</a>)</span>: ¿cuánto de esta menor producción es explicado por radiación interceptada, por eficiencia fotosintética del canopeo y por contenido energético del producto?</li>
</ol>
<p>(Por hacer)</p>
<hr />
<div id="refs" class="references hanging-indent">
<div id="ref-andrade1995analysis">
<p>Andrade, Fernando H. 1995. “Analysis of Growth and Yield of Maize, Sunflower and Soybean Grown at Balcarce, Argentina.” <em>Field Crops Research</em> 41 (1): 1–12.</p>
</div>
<div id="ref-monsi1953light">
<p>Monsi, M, and T Saeki. 1953. “The Light Factor in Plant Communities and Its Significance for Dry Matter Production.” <em>Japanese Journal of Botany</em> 14 (1): 22–52.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
